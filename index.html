<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Ramadan Calendar - Installable Version</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Web App Manifest for installation -->
    <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22Ramadan%20Calendar%22%2C%22short_name%22%3A%22Ramadan%20Cal%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22theme_color%22%3A%22%231a2e1a%22%2C%22background_color%22%3A%22%231a2e1a%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22%231a2e1a%22%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2265%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23ffd966%22%3EğŸŒ™%3C%2Ftext%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%5D%7D">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: #1a2e1a;
            padding: 20px;
        }
        
        .admin-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .calendar-container {
            max-width: 500px;
            margin: 0 auto;
            background: #faf3e2;
            border-radius: 50px 15px 50px 15px;
            padding: 20px;
            border: 3px solid #c9a75a;
        }
        
        .header {
            background: linear-gradient(135deg, #1e4a2e, #0f3a1f);
            border-radius: 40px 8px 40px 8px;
            padding: 20px;
            margin-bottom: 25px;
            border: 3px solid #c9a75a;
            color: white;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            color: #ffd966;
            font-family: 'Amiri', serif;
        }
        
        .admin-badge {
            background: #ffd966;
            color: #1a2e1a;
            padding: 5px 15px;
            border-radius: 50px;
            display: inline-block;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .install-badge {
            background: #4CAF50;
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            display: inline-block;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .generator-container {
            background: #faf3e2;
            border-radius: 50px 15px 50px 15px;
            padding: 30px;
            border: 3px solid #c9a75a;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .section {
            background: white;
            border-radius: 30px 8px 30px 8px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #c9a75a;
        }
        
        .section-title {
            color: #1e4a2e;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-right: 4px solid #c9a75a;
            padding-right: 15px;
        }
        
        .profile-card {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .profile-image {
            width: 80px;
            height: 80px;
            background: #e0e0e0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px solid #c9a75a;
        }
        
        .profile-image i {
            font-size: 2.5rem;
            color: #888;
        }
        
        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-info h2 {
            color: #1e4a2e;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .profile-info p {
            color: #555;
            margin-bottom: 5px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group.full-width {
            grid-column: span 2;
        }
        
        label {
            display: block;
            color: #1e4a2e;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .required {
            color: #e53e3e;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: 0.3s;
            font-family: 'Inter', sans-serif;
        }
        
        .readonly-field {
            background: #f0f0f0;
            border: 2px solid #c9a75a;
            color: #333;
        }
        
        .profile-upload {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .profile-preview {
            width: 100px;
            height: 100px;
            background: #e0e0e0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px dashed #c9a75a;
        }
        
        .profile-preview i {
            font-size: 3rem;
            color: #888;
        }
        
        .profile-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 15px;
        }
        
        .card {
            background: #f9f9f9;
            border-radius: 20px;
            padding: 15px;
            border: 1px solid #c9a75a;
            position: relative;
        }
        
        .calendar-card {
            background: linear-gradient(135deg, #fff9e6, #fff);
            border: 2px solid #c9a75a;
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #1e4a2e;
        }
        
        .card-header h3 {
            font-size: 1.2rem;
        }
        
        .badge {
            background: #c9a75a;
            color: #1e4a2e;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .ad-link {
            display: block;
            background: #1e4a2e;
            color: #ffd966;
            text-decoration: none;
            padding: 10px;
            border-radius: 30px;
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background: #e8f0e8;
            border-radius: 30px;
        }
        
        .toggle-label {
            font-size: 0.9rem;
            color: #1a2e1a;
            font-weight: 500;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #1e4a2e;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .delete-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 30px;
            height: 30px;
            background: #e53e3e;
            color: white;
            border: 2px solid #c9a75a;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.3s;
            z-index: 10;
        }
        
        .hidden-card {
            opacity: 0.5;
            background: #e0e0e0;
            pointer-events: none;
        }
        
        .status-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 5px;
        }
        
        .status-active {
            background: #4CAF50;
            color: white;
        }
        
        .status-inactive {
            background: #e53e3e;
            color: white;
        }
        
        .generate-btn {
            width: 100%;
            padding: 20px;
            background: #1e4a2e;
            color: #ffd966;
            border: none;
            border-radius: 50px;
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .export-btn {
            width: 100%;
            padding: 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .footer {
            text-align: center;
            color: #faf3e2;
            margin-top: 20px;
        }
        
        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            color: #856404;
        }
        
        .install-instruction {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            color: #155724;
            text-align: center;
        }
        
        .install-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .mode-indicator {
            text-align: center;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .mode-edit {
            color: #1e4a2e;
            background: #e8f0e8;
            padding: 5px 15px;
            border-radius: 30px;
            display: inline-block;
        }
        
        .mode-view {
            color: #155724;
            background: #d4edda;
            padding: 5px 15px;
            border-radius: 30px;
            display: inline-block;
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container" id="mainContainer">
        <!-- Dynamic content will be loaded here -->
    </div>
    
    <script>
        // Check if running in standalone mode (installed)
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches || 
                             window.navigator.standalone || 
                             document.referrer.includes('android-app://');
        
        // Main initialization
        document.addEventListener('DOMContentLoaded', function() {
            loadContent();
        });
        
        function loadContent() {
            const container = document.getElementById('mainContainer');
            
            // Try to load saved data
            const savedData = loadSavedData();
            
            if (isStandalone) {
                // INSTALLED MODE - Show only calendar view (no editing)
                renderCalendarView(container, savedData);
            } else {
                // NORMAL MODE - Show admin panel with editing
                renderAdminPanel(container, savedData);
            }
        }
        
        function loadSavedData() {
            try {
                // Try to get data from URL parameter first
                const urlParams = new URLSearchParams(window.location.search);
                const id = urlParams.get('id');
                
                if (id) {
                    // Try multiple storage locations
                    const localData = localStorage.getItem(id);
                    if (localData) return JSON.parse(localData);
                    
                    const sessionData = sessionStorage.getItem(id);
                    if (sessionData) return JSON.parse(sessionData);
                    
                    // Try cookie
                    const cookies = document.cookie.split(';');
                    for (let cookie of cookies) {
                        const [name, value] = cookie.trim().split('=');
                        if (name === id) {
                            return JSON.parse(decodeURIComponent(value));
                        }
                    }
                }
                
                // Default data if nothing found
                return {
                    businessName: 'Ø§Ù„Ù…Ø¯ÛŒÙ†Û Ø¬ÛŒÙˆÙ„Ø±Ø²',
                    phoneNumber: '03001234567',
                    email: 'info@example.com',
                    businessType: 'Jewellery Store',
                    address: 'Ù…Ø§ÚˆÙ„ Ù¹Ø§Ø¤Ù†ØŒ Ù„Ø§ÛÙˆØ±',
                    businessDetails: 'Ø³ÙˆÙ†Û’ Ú†Ø§Ù†Ø¯ÛŒ Ú©ÛŒ Ø®Ø§Ù„Øµ Ù…ØµÙ†ÙˆØ¹Ø§Øª',
                    profileIcon: 'fa-store',
                    ad1: { text: 'Ù†Ø¦ÛŒ Ú¯ÙˆÙ„Úˆ Ú©Ù„Ú©Ø´Ù†', link: 'https://example.com/gold', icon: 'fa-gem', clickable: true, deleted: false },
                    ad2: { text: 'Ø´Ø§Ø¯ÛŒ Ø¨ÛŒØ§Û ÚˆÛŒÙ„Ø²', link: 'https://example.com/wedding', icon: 'fa-heart', clickable: true, deleted: false },
                    ad3: { text: 'Ø±Ù…Ø¶Ø§Ù† Ø³Ù¾ÛŒØ´Ù„', link: 'https://example.com/ramadan', icon: 'fa-moon', clickable: true, deleted: false },
                    banner1: { text: '25% ØªØ®ÙÛŒÙ', link: 'https://example.com/discount', icon: 'fa-percent', clickable: true, deleted: false },
                    banner2: { text: 'ÙØ±ÛŒ ÚˆÙ„ÛŒÙˆØ±ÛŒ', link: 'https://example.com/delivery', icon: 'fa-truck', clickable: true, deleted: false },
                    banner3: { text: 'Ù„Ú©ÛŒ ÚˆØ±Ø§', link: 'https://example.com/lucky', icon: 'fa-trophy', clickable: true, deleted: false }
                };
            } catch (e) {
                console.error('Error loading data:', e);
                return null;
            }
        }
        
        function renderAdminPanel(container, data) {
            if (!data) data = loadSavedData();
            
            container.innerHTML = `
                <div class="header">
                    <h1>ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† 1447</h1>
                    <p>Ú©ÛŒÙ„Ù†ÚˆØ± Ø¬Ù†Ø±ÛŒÙ¹Ø± - Ø§ÛŒÚˆÙ…Ù† Ù¾ÛŒÙ†Ù„</p>
                    <div class="admin-badge">
                        <i class="fas fa-lock"></i> ØµØ±Ù Ø§ÛŒÚˆÙ…Ù† Ú©Û’ Ù„ÛŒÛ’
                    </div>
                </div>
                
                <div class="generator-container">
                    <div class="mode-indicator">
                        <span class="mode-edit"><i class="fas fa-edit"></i> ØªØ±Ù…ÛŒÙ… Ù…ÙˆÚˆ</span>
                    </div>
                    
                    <div class="install-instruction">
                        <i class="fas fa-download"></i> Ø§ÛŒÙ¾ Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’:<br>
                        Chrome: â‹® > Home screen Ù¾Ø± Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº<br>
                        Safari: Share > Add to Home Screen
                    </div>
                    
                    <!-- Profile Section -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-store"></i>
                            Ú©Ø§Ø±ÙˆØ¨Ø§Ø± Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª
                        </div>
                        
                        <div class="profile-upload">
                            <div class="profile-preview" id="profilePreview">
                                <i class="fas ${data.profileIcon || 'fa-store'}"></i>
                            </div>
                            <div>
                                <input type="file" id="profilePic" accept="image/*" style="display:none;" onchange="previewImage(this)">
                                <button class="upload-btn" onclick="document.getElementById('profilePic').click()">
                                    <i class="fas fa-upload"></i> ØªØµÙˆÛŒØ± Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label><span class="required">*</span> Ú©Ø§Ø±ÙˆØ¨Ø§Ø± Ú©Ø§ Ù†Ø§Ù…</label>
                                <input type="text" id="businessName" value="${escapeHtml(data.businessName || '')}">
                            </div>
                            
                            <div class="form-group">
                                <label><span class="required">*</span> ÙÙˆÙ† Ù†Ù…Ø¨Ø±</label>
                                <input type="text" id="phoneNumber" value="${escapeHtml(data.phoneNumber || '')}">
                            </div>
                            
                            <div class="form-group">
                                <label>Ø§ÛŒ Ù…ÛŒÙ„</label>
                                <input type="email" id="email" value="${escapeHtml(data.email || '')}">
                            </div>
                            
                            <div class="form-group">
                                <label><span class="required">*</span> Ú©Ø§Ø±ÙˆØ¨Ø§Ø± Ú©ÛŒ Ù‚Ø³Ù…</label>
                                <input type="text" id="businessType" value="${escapeHtml(data.businessType || '')}">
                            </div>
                            
                            <div class="form-group full-width">
                                <label><span class="required">*</span> Ù…Ú©Ù…Ù„ Ù¾ØªÛ</label>
                                <textarea id="address" rows="2">${escapeHtml(data.address || '')}</textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label>ØªÙØµÛŒÙ„</label>
                                <textarea id="businessDetails" rows="2">${escapeHtml(data.businessDetails || '')}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label>Ø¢Ø¦ÛŒÚ©ÙˆÙ†</label>
                                <div class="icon-selector">
                                    <div class="icon-preview" id="profileIconPreview">
                                        <i class="fas ${data.profileIcon || 'fa-store'}"></i>
                                    </div>
                                    <select id="profileIcon" onchange="updateIconPreview(this.value)">
                                        <option value="fa-store" ${data.profileIcon === 'fa-store' ? 'selected' : ''}>Ø§Ø³Ù¹ÙˆØ±</option>
                                        <option value="fa-gem" ${data.profileIcon === 'fa-gem' ? 'selected' : ''}>Ø¬ÛŒÙˆÙ„Ø±ÛŒ</option>
                                        <option value="fa-stethoscope" ${data.profileIcon === 'fa-stethoscope' ? 'selected' : ''}>Ù…ÛŒÚˆÛŒÚ©Ù„</option>
                                        <option value="fa-utensils" ${data.profileIcon === 'fa-utensils' ? 'selected' : ''}>ÙÙˆÚˆ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Top Ads -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-ad"></i>
                            Ù¹Ø§Ù¾ Ø§ÛŒÚˆØ²
                        </div>
                        
                        <div class="cards-grid" id="topAdsContainer">
                            ${renderAdCard('ad1', data.ad1)}
                            ${renderAdCard('ad2', data.ad2)}
                            ${renderAdCard('ad3', data.ad3)}
                        </div>
                    </div>
                    
                    <!-- Bottom Banners -->
                    <div class="section">
                        <div class="section-title">
                            <i class="fas fa-images"></i>
                            Ù†ÛŒÚ†Û’ Ø¨ÛŒÙ†Ø±Ø²
                        </div>
                        
                        <div class="cards-grid" id="bottomBannersContainer">
                            ${renderBannerCard('banner1', data.banner1)}
                            ${renderBannerCard('banner2', data.banner2)}
                            ${renderBannerCard('banner3', data.banner3)}
                        </div>
                    </div>
                    
                    <button class="generate-btn" onclick="generateCalendar()">
                        <i class="fas fa-calendar-alt"></i>
                        Ú©ÛŒÙ„Ù†ÚˆØ± Ø¨Ù†Ø§Ø¦ÛŒÚº
                    </button>
                    
                    <button class="export-btn" onclick="exportData()">
                        <i class="fas fa-download"></i> ÚˆÛŒÙ¹Ø§ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø±ÛŒÚº
                    </button>
                </div>
                
                <div class="footer">
                    <p>ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ú© 1447Ú¾</p>
                </div>
            `;
            
            // Load profile picture if exists
            const savedPic = localStorage.getItem('profilePic');
            if (savedPic) {
                document.getElementById('profilePreview').innerHTML = `<img src="${savedPic}" style="width:100%;height:100%;object-fit:cover;">`;
            }
        }
        
        function renderCalendarView(container, data) {
            if (!data) data = loadSavedData();
            
            container.innerHTML = `
                <div class="header">
                    <h1>ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† 1447</h1>
                    <p>Ú©ÛŒÙ„Ù†ÚˆØ± - Ù†ØµØ¨ Ø´Ø¯Û ÙˆØ±Ú˜Ù†</p>
                    <div class="install-badge">
                        <i class="fas fa-check-circle"></i> Ø§Ù†Ø³Ù¹Ø§Ù„ Ø´Ø¯Û
                    </div>
                </div>
                
                <div class="calendar-container">
                    <div class="mode-indicator">
                        <span class="mode-view"><i class="fas fa-eye"></i> ØµØ±Ù Ø¯ÛŒÚ©Ú¾Ù†Û’ Ú©Ø§ Ù…ÙˆÚˆ</span>
                    </div>
                    
                    <!-- Business Profile -->
                    <div class="profile-card">
                        <div class="profile-image" id="calendarProfileImage">
                            ${localStorage.getItem('profilePic') ? 
                              `<img src="${localStorage.getItem('profilePic')}">` : 
                              `<i class="fas ${data.profileIcon || 'fa-store'}"></i>`}
                        </div>
                        <div class="profile-info">
                            <h2>${escapeHtml(data.businessName || '')}</h2>
                            <p><i class="fas fa-phone"></i> ${escapeHtml(data.phoneNumber || '')}</p>
                            <p><i class="fas fa-map-marker"></i> ${escapeHtml(data.address || '')}</p>
                        </div>
                    </div>
                    
                    <!-- Top Ads Section -->
                    <div style="margin: 20px 0;">
                        <h3 style="color: #1e4a2e; margin-bottom: 10px;">Ù¾Ø±ÙˆÙ…ÙˆØ´Ù†Ø²</h3>
                        ${renderCalendarAds(data)}
                    </div>
                    
                    <!-- Calendar Placeholder -->
                    <div class="calendar-card">
                        <div class="card-header">
                            <h3>Ø±Ù…Ø¶Ø§Ù† 1447</h3>
                            <span class="badge">1 Ø±Ù…Ø¶Ø§Ù†</span>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #e8f0e8; border-radius: 15px;">
                            <p><i class="fas fa-clock"></i> Ø³Ø­Ø±ÛŒ: 4:30 AM</p>
                            <p><i class="fas fa-clock"></i> Ø§ÙØ·Ø§Ø±: 6:45 PM</p>
                            <p style="margin-top: 10px; color: #1e4a2e;">ğŸŒ™ 30 Ø±ÙˆØ²Û’</p>
                        </div>
                    </div>
                    
                    <!-- Bottom Banners -->
                    <div style="margin-top: 20px;">
                        ${renderCalendarBanners(data)}
                    </div>
                </div>
                
                <div class="footer">
                    <p>ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ú© - Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÙˆÚˆ</p>
                </div>
            `;
        }
        
        function renderAdCard(id, ad) {
            if (!ad) ad = { text: '', link: '', icon: 'fa-gem', clickable: true, deleted: false };
            const hiddenClass = ad.deleted ? 'hidden-card' : '';
            const statusText = ad.deleted ? 'Ø­Ø°Ù Ø´Ø¯Û' : (ad.clickable ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ± ÙØ¹Ø§Ù„');
            const statusClass = ad.deleted ? 'status-inactive' : (ad.clickable ? 'status-active' : 'status-inactive');
            
            return `
                <div class="card ${hiddenClass}" id="${id}Card">
                    <div class="delete-btn" onclick="deleteCard('${id}')">
                        <i class="fas fa-times"></i>
                    </div>
                    <h4>${id.toUpperCase()} <span id="${id}Status" class="status-badge ${statusClass}">${statusText}</span></h4>
                    
                    <div class="toggle-container">
                        <span class="toggle-label"><i class="fas fa-mouse-pointer"></i> Ú©Ù„Ú© Ø§ÛŒØ¨Ù„</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="${id}Clickable" ${ad.clickable ? 'checked' : ''} onchange="toggleClickable('${id}')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <input type="text" id="${id}Text" value="${escapeHtml(ad.text || '')}" placeholder="Ù…ØªÙ†" style="margin-bottom:5px;">
                    <input type="text" id="${id}Link" value="${escapeHtml(ad.link || '')}" placeholder="Ù„Ù†Ú©" style="margin-bottom:5px;">
                    
                    <select id="${id}Icon" style="margin-top:5px;">
                        <option value="fa-gem" ${ad.icon === 'fa-gem' ? 'selected' : ''}>Ø¬ÛŒÙˆÙ„Ø±ÛŒ</option>
                        <option value="fa-percent" ${ad.icon === 'fa-percent' ? 'selected' : ''}>ØªØ®ÙÛŒÙ</option>
                        <option value="fa-heart" ${ad.icon === 'fa-heart' ? 'selected' : ''}>Ø´Ø§Ø¯ÛŒ</option>
                        <option value="fa-gift" ${ad.icon === 'fa-gift' ? 'selected' : ''}>ØªØ­ÙÛ</option>
                        <option value="fa-moon" ${ad.icon === 'fa-moon' ? 'selected' : ''}>Ø±Ù…Ø¶Ø§Ù†</option>
                        <option value="fa-star" ${ad.icon === 'fa-star' ? 'selected' : ''}>Ø³ØªØ§Ø±Û</option>
                    </select>
                </div>
            `;
        }
        
        function renderBannerCard(id, banner) {
            if (!banner) banner = { text: '', link: '', icon: 'fa-percent', clickable: true, deleted: false };
            const hiddenClass = banner.deleted ? 'hidden-card' : '';
            const statusText = banner.deleted ? 'Ø­Ø°Ù Ø´Ø¯Û' : (banner.clickable ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ± ÙØ¹Ø§Ù„');
            const statusClass = banner.deleted ? 'status-inactive' : (banner.clickable ? 'status-active' : 'status-inactive');
            
            return `
                <div class="card ${hiddenClass}" id="${id}Card">
                    <div class="delete-btn" onclick="deleteCard('${id}')">
                        <i class="fas fa-times"></i>
                    </div>
                    <h4>${id.toUpperCase()} <span id="${id}Status" class="status-badge ${statusClass}">${statusText}</span></h4>
                    
                    <div class="toggle-container">
                        <span class="toggle-label"><i class="fas fa-mouse-pointer"></i> Ú©Ù„Ú© Ø§ÛŒØ¨Ù„</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="${id}Clickable" ${banner.clickable ? 'checked' : ''} onchange="toggleClickable('${id}')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <input type="text" id="${id}Text" value="${escapeHtml(banner.text || '')}" placeholder="Ù…ØªÙ†" style="margin-bottom:5px;">
                    <input type="text" id="${id}Link" value="${escapeHtml(banner.link || '')}" placeholder="Ù„Ù†Ú©" style="margin-bottom:5px;">
                    
                    <select id="${id}Icon" style="margin-top:5px;">
                        <option value="fa-percent" ${banner.icon === 'fa-percent' ? 'selected' : ''}>ØªØ®ÙÛŒÙ</option>
                        <option value="fa-tags" ${banner.icon === 'fa-tags' ? 'selected' : ''}>ÚˆÛŒÙ„</option>
                        <option value="fa-truck" ${banner.icon === 'fa-truck' ? 'selected' : ''}>ÚˆÙ„ÛŒÙˆØ±ÛŒ</option>
                        <option value="fa-box" ${banner.icon === 'fa-box' ? 'selected' : ''}>Ù¾ÛŒÚ©Ø¬</option>
                        <option value="fa-trophy" ${banner.icon === 'fa-trophy' ? 'selected' : ''}>Ø§Ù†Ø¹Ø§Ù…</option>
                        <option value="fa-gem" ${banner.icon === 'fa-gem' ? 'selected' : ''}>Ø¬ÛŒÙˆÙ„Ø±ÛŒ</option>
                    </select>
                </div>
            `;
        }
        
        function renderCalendarAds(data) {
            let html = '';
            const ads = ['ad1', 'ad2', 'ad3'];
            
            ads.forEach(adId => {
                const ad = data[adId];
                if (ad && !ad.deleted && ad.text) {
                    html += `
                        <div class="card" style="margin-bottom: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas ${ad.icon || 'fa-gem'}" style="color: #c9a75a; font-size: 1.5rem;"></i>
                                <div style="flex: 1;">
                                    <p style="font-weight: 600;">${escapeHtml(ad.text)}</p>
                                    ${ad.clickable ? 
                                      `<a href="${escapeHtml(ad.link)}" class="ad-link" target="_blank">
                                          <i class="fas fa-external-link"></i> Ú©Ù„Ú© Ú©Ø±ÛŒÚº
                                       </a>` : 
                                      `<p style="color: #999;"><i class="fas fa-ban"></i> ØºÛŒØ± ÙØ¹Ø§Ù„</p>`}
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            return html || '<p style="color: #999;">Ú©ÙˆØ¦ÛŒ Ø§ÛŒÚˆØ² Ù†ÛÛŒÚº</p>';
        }
        
        function renderCalendarBanners(data) {
            let html = '';
            const banners = ['banner1', 'banner2', 'banner3'];
            
            banners.forEach(bannerId => {
                const banner = data[bannerId];
                if (banner && !banner.deleted && banner.text) {
                    html += `
                        <div style="background: linear-gradient(135deg, #1e4a2e, #0f3a1f); color: white; padding: 15px; border-radius: 15px; margin-bottom: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas ${banner.icon || 'fa-percent'}" style="color: #ffd966; font-size: 2rem;"></i>
                                <div style="flex: 1;">
                                    <p style="font-weight: 600;">${escapeHtml(banner.text)}</p>
                                    ${banner.clickable ? 
                                      `<a href="${escapeHtml(banner.link)}" style="color: #ffd966; text-decoration: underline; font-size: 0.9rem;">
                                          <i class="fas fa-external-link"></i> ØªÙØµÛŒÙ„Ø§Øª
                                       </a>` : 
                                      `<span style="color: #999;"><i class="fas fa-ban"></i> ØºÛŒØ± ÙØ¹Ø§Ù„</span>`}
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            return html || '<p style="color: #999;">Ú©ÙˆØ¦ÛŒ Ø¨ÛŒÙ†Ø±Ø² Ù†ÛÛŒÚº</p>';
        }
        
        // Helper function to escape HTML
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Admin panel functions
        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profilePreview').innerHTML = `<img src="${e.target.result}" style="width:100%;height:100%;object-fit:cover;">`;
                    localStorage.setItem('profilePic', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        
        function updateIconPreview(iconClass) {
            const preview = document.getElementById('profileIconPreview');
            if (preview) {
                preview.innerHTML = `<i class="fas ${iconClass}"></i>`;
            }
        }
        
        function toggleClickable(id) {
            const checkbox = document.getElementById(id + 'Clickable');
            const statusSpan = document.getElementById(id + 'Status');
            
            if (checkbox.checked) {
                statusSpan.textContent = 'ÙØ¹Ø§Ù„';
                statusSpan.className = 'status-badge status-active';
            } else {
                statusSpan.textContent = 'ØºÛŒØ± ÙØ¹Ø§Ù„';
                statusSpan.className = 'status-badge status-inactive';
            }
        }
        
        function deleteCard(id) {
            const card = document.getElementById(id + 'Card');
            
            if (card.classList.contains('hidden-card')) {
                card.classList.remove('hidden-card');
                const statusSpan = document.getElementById(id + 'Status');
                const checkbox = document.getElementById(id + 'Clickable');
                
                statusSpan.textContent = checkbox.checked ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ± ÙØ¹Ø§Ù„';
                statusSpan.className = checkbox.checked ? 'status-badge status-active' : 'status-badge status-inactive';
            } else {
                card.classList.add('hidden-card');
                const statusSpan = document.getElementById(id + 'Status');
                statusSpan.textContent = 'Ø­Ø°Ù Ø´Ø¯Û';
                statusSpan.className = 'status-badge status-inactive';
            }
        }
        
        function collectFormData() {
            return {
                businessName: document.getElementById('businessName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                email: document.getElementById('email').value,
                businessType: document.getElementById('businessType').value,
                address: document.getElementById('address').value,
                businessDetails: document.getElementById('businessDetails').value,
                profileIcon: document.getElementById('profileIcon').value,
                
                ad1: {
                    text: document.getElementById('ad1Text').value,
                    link: document.getElementById('ad1Link').value,
                    icon: document.getElementById('ad1Icon').value,
                    clickable: document.getElementById('ad1Clickable').checked,
                    deleted: document.getElementById('ad1Card').classList.contains('hidden-card')
                },
                ad2: {
                    text: document.getElementById('ad2Text').value,
                    link: document.getElementById('ad2Link').value,
                    icon: document.getElementById('ad2Icon').value,
                    clickable: document.getElementById('ad2Clickable').checked,
                    deleted: document.getElementById('ad2Card').classList.contains('hidden-card')
                },
                ad3: {
                    text: document.getElementById('ad3Text').value,
                    link: document.getElementById('ad3Link').value,
                    icon: document.getElementById('ad3Icon').value,
                    clickable: document.getElementById('ad3Clickable').checked,
                    deleted: document.getElementById('ad3Card').classList.contains('hidden-card')
                },
                
                banner1: {
                    text: document.getElementById('banner1Text').value,
                    link: document.getElementById('banner1Link').value,
                    icon: document.getElementById('banner1Icon').value,
                    clickable: document.getElementById('banner1Clickable').checked,
                    deleted: document.getElementById('banner1Card').classList.contains('hidden-card')
                },
                banner2: {
                    text: document.getElementById('banner2Text').value,
                    link: document.getElementById('banner2Link').value,
                    icon: document.getElementById('banner2Icon').value,
                    clickable: document.getElementById('banner2Clickable').checked,
                    deleted: document.getElementById('banner2Card').classList.contains('hidden-card')
                },
                banner3: {
                    text: document.getElementById('banner3Text').value,
                    link: document.getElementById('banner3Link').value,
                    icon: document.getElementById('banner3Icon').value,
                    clickable: document.getElementById('banner3Clickable').checked,
                    deleted: document.getElementById('banner3Card').classList.contains('hidden-card')
                }
            };
        }
        
        function generateCalendar() {
            const data = collectFormData();
            const id = 'cal_' + Date.now();
            
            // Save everywhere
            localStorage.setItem(id, JSON.stringify(data));
            sessionStorage.setItem(id, JSON.stringify(data));
            document.cookie = `${id}=${JSON.stringify(data)}; max-age=2592000; path=/`;
            
            // Open in same window with parameter
            window.location.href = '?id=' + id;
        }
        
        function exportData() {
            const data = collectFormData();
            const dataStr = JSON.stringify(data, null, 2);
            
            const blob = new Blob([dataStr], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ramadan-data.txt';
            a.click();
            
            alert('ÚˆÛŒÙ¹Ø§ export ÛÙˆ Ú¯ÛŒØ§! Ø§Ø³Û’ Ù…Ø­ÙÙˆØ¸ Ø±Ú©Ú¾ÛŒÚºÛ”');
        }
        
        // Make functions global
        window.previewImage = previewImage;
        window.updateIconPreview = updateIconPreview;
        window.toggleClickable = toggleClickable;
        window.deleteCard = deleteCard;
        window.generateCalendar = generateCalendar;
        window.exportData = exportData;
    </script>
</body>
</html>
